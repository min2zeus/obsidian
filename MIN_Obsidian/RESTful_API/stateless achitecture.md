# 1. state
## 1.1 state 이란?
* 네트워크는 크게 서버(정보를 제공)와 클라이언트(정보를 요청하여 수신)로 나눌 수 있음.
* 서버와 클라이언트 통신에서 이전의 대화 기록을 보유하고 있는지 그렇지 않는지에 따라서 stateless 혹은 stateful로 분류할 수 있음.

## 1.2 stateful 이란?
* 클라이언트는 서버로 request 메시지를 송신하고, 서버는 그에 대한 response 메시지를 보냄. request와 그에 대한 response를 주고받는 것을 세션이라고 하며, stateful 아키텍처에서는 세션의 정보, 상태를 지속적으로 기록.
* stateful 아키텍처에서는 세션이 중단되어도 이전의 세션 정보, 상태를 가지고 있기에 클라이언트는 세션이 재 연결되면 이전에 진행했던 내용을 다시 요청할 수 있음.
* 예를 들면, A라는 사람이 식당에 가서 음식을 주문할 때, '맵지 않게 해주세요', '오이 빼주세요' 라고 주문하면, 다음 번에 방문 했을 때 따로 이야기를 하지 않아도 맵지 않게, 오이 빼주는 것이라고 할 수 있음.
* stateful 아키텍처는 로그인이 필요한 서비스에 적합.
* stateful 아키텍처의 단점
	* 서버에서 많은 양의 클라이언트 데이터를 가지고 있어야 하는 부담이 있음.
	* 서버와 클라이언트의 종속성 문제가 있을 수 있음. 즉 하나의 서버에서 장애가 발생할 경우, 해당 서버가 담당했던 클라이언트들은 원활하게 서비스를 받을 수 없음. (예를 들면, 파트원이 휴가 갔을 때, 부 담당자가 지원을 하는 경우와 같음.)
	
## 1.3 stateless 이란?
* stateless 아키텍처에서는 서버와 클라이언트 사이의 request, response 기록을 남기지 않음.
* 만약 세션 정보를 저장해야 한다면 클라이언트에 캐시 형태로 보관.
* 클라이언트에서 request 시 요구 사항을 자세히 작성해야 함.
* 모든 서버에서 클라이언트의 request를 처리할 수 있음. 
* stateful과는 다르게 서버와 클라이언트의 종속성이 없기에 서버 확장/축소 용이.

## 1.4 summary

| | stateful | stateless|
| ----------- | ----------- | ----------- |
|장점| 이전 컨텍스트 추적 가능하여 메시지 전달 효율 좋음.<br> 준수한 요청 처리 성능|장애에 유연한 대응.<br> 서버 규모 확장/축소 쉬움.<br> 서버가 부담하는 리소스 감소.|
|단점| 서버에 state 관리를 위한 저장 공간 필요. <br> 클라이언트와 서버의 종속성 존재.|클라이언트 송신 데이터가 커질 수 있음.|
|예| HTTP, DNS | FTP, Telnet | 

# 2. 처리율 제한

## 2.1 처리율 제한 장치란?
* 네트워크 시스템에서 처리율 제한 장치는 클라이언트에서 보내는 request의 처리율을 제어하기 위한 장치.
* HTTP를 예로 들면, 특정 기간 내에 전송되는 클라이언트의 요청 횟수를 제한.
* API를 예로 들면, API 요청 횟수가 처리율 제한 장치에 정의된 임계치를 넘어서면 추가 요청은 모두 중단 됨.

## 2.2 처리율 제한 장치의 장점
* Dos(Denial of Service) 공격에 의한 자원 고갈 예방.
	* 트위터는 3시간동안 300개의 트윗 제한.
	* 구글 독스 API는 유저당 분당 300회의 read 제한.
* 비용 절감.
	* 추가 요청에 대한 처리 제한 시 서버가 많이 필요 없음.
	* 우선 순위 높은 API에 많은 자원을 할당할 수 있음.
* 서버 과부하 예방.
	* 봇에서 오는 트래픽, 사용자의 잘못된 이용으로 인한 트래픽을 차단할 수 있음.


## 2.3 처리율 제한 장치의 구성
* API Gateway
	* 처리율 제한 장치를 API 서버에 구성하되, 처리율 제한 미들웨어를 구성하여 API 서버로 가는 요청을 제어할 수 있음.
	* API Gateway는 처리율 제한, SSL 종단, 사용자 인증, IP 허용 목록 관리 서비스 등의 제공
* 처리율 한도 초과 트리픽 처리
	* 어떤 요청이 한도 제한에 걸리면 API는 HTTP 429 응답(too many requests) 전송.

## 2.4 처리율 제한 알고리즘
* 토큰 버킷 알고리즘
	https://etloveguitar.tistory.com/128
* 누출 버킷 알고리즘
	https://etloveguitar.tistory.com/127
* 고정 윈도 카운터 알고리즘
	https://etloveguitar.tistory.com/129
* 이동 윈도 로그 알고리즘
	https://etloveguitar.tistory.com/130
* 이동 윈도 카운터 알고리즘


# 3. 비 관계형 데이터베이스(NoSQL)

## 3.1 noSQL 이란?
* not only SQL 데이터베이스.
* 비 관계형 데이터베이스로 관계형 테이블과는 다른 형식으로 데이터를 저장.
* NoSQL 데이터베이스는 언어마다 관습화된 API, 선언적 구조의 쿼리 언어, 쿼리별 언어를 사용하여 질의할 수 있음.

## 3.2 noSQL 용도
* 확장성, 가용성에 장점이 있어 실시간 웹 애플리케이션 및 빅 데이터에 사용됨.
  (다운 타임이 없는 클라우드의 장점을 누릴 수 있음)
* 보다 직관적이고 이해하기 쉬운 방식 또는 애플리케이션이 사용하는 것에 가까운 방식으로 데이터 저장.
* NoSQL 스타일의 API를 사용하면 저장, 검색 시 데이터 변환의 필요성이 줄어듬.
* NoSQL 데이터베이스는 유연한 스키마를 제공하고, 대량의 데이터 및 낮은 대기시간 또는 응답시간을 요구하는 애플리케이션 구축에 이상적인 다양한 데이터 모델 지원.

## 3.3 SQL과 NoSQL 비교
* SQL 데이터베이스는 관계형인 반면 NoSQL 데이터베이스는 비 관계형.
* NoSQL 데이터베이스에서는 데이터 액세스 구문이 데이터베이스마다 다름.
* SQL
	* RDBMS의 데이터는 테이블이라고 불리는 데이터베이스 객체에 저장.
	* 테이블은 관계형 데이터 항목 모음이고, 열과 행으로 구성.
	* 데이터베이스에서는 스키마를 사전에 정의해야 함.
		즉, 모든 열과 그와 관련된 데이터 유형이 사전에 파악되어야 애플리케이션이 데이터를 데이터베이스에 작성 가능.
	* 키는 특정 행을 검색하는 데 사용되며, 검사 또는 수정 가능.
* NoSQL
	* 사전에 스키마를 정의하지 않아도 저장 가능.
	* 작업을 진행하는 동시에 데이터를 정의하는 방식으로 빠르게 데이터 작성 가능.
	* 그래프 기반, 열 지향, 문서 지향 또는 키-값 저장소 등 특정 비즈니스 요구 사항 수행에 적합.
		* 키 값 : 가장 유연한 NoSQL 데이터베이스 유형, 애플리케이션이 값 필드에 저장된 모든 데이터를 제약 없이 완벽하게 제어.
		* 문서 : 문서 저장소 또는 문서 지향적 데이터베이스라고 불림. 반구조적 데이터의 저장, 검색, 관리에 사용.
		* 그래프 : 이 데이터베이스는 데이터를 노드 및 노드 간 연결을 보여주는 관계로 구성. 소셜 네트워크, 예약 시스템, 사기 감지 등에 적용.
		* 넓은 열 : 이 데이터베이스는 테이블, 행, 열 형식으로 데이터를 저장 및 관리. 열 형식을 사용하는 애플리케이션에 광범위하게 배포되어 스키마 없는 데이터를 수집.
	* 데이터의 다양성, 속도, 양을 감당하기 위한 새로운 데이터 베이스.
	* 신속한 수평적 확장 능력 덕분에 NoSQL은 높은 트래픽을 처리.
	* 비 정규화된 데이터를 저장하고 적은 수의 데이터를 사용하는 애플리케이션 유형을 지원. (대다수의 금융, 회계, 기업 리소스 계획을 위한 고전적인 백오피스 비즈니스 애플리케이션은 데이터 변형 및 데이터 중복을 방지하기 위해 고도로 정규화된 데이터에 의존하기에, NoSQL에 어울리지 않음.)
	* NoSQL 데이터베이스는 단일 테이블에 대한 쿼리 작업에 적합.

* SQL과 NoSQL 용어 비교

| **SQL** | **MongoDB** | **DynamoDB** | **Cassandra** | **Couchbase** |
| ----------- | ----------- | ----------- | ----------- | ----------- |
| 테이블 | 컬렉션 | 테이블 | 테이블 | 데이터 버킷 |
| 열	| 문서 |	항목 |	열 |	문서 |
| 컬럼	|필드|	속성|	컬럼|	필드|
| 기본 키|	ObjectId|	기본 키| 기본 키|	문서 ID|
|인덱스	|인덱스	|보조 인덱스|	인덱스|	인덱스|
|보기|	보기|	글로벌 보조 인덱스|	구체화된 보기|	보기|
|중첩된 테이블 또는 객체|	포함 문서|	맵|	맵|	맵|
|배열|	배열|	목록|	목록|	목록|

